<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto G29</title>
    <link rel="icon" href="image/favicon.png" type="image/png">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <link rel="stylesheet" href="css/estilo.css">
    <link rel="stylesheet" href="css/styleModalAcc.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>

    <div class="sidebar">
        <a href="index.html"><i class="fa fa-fw fa-home"></i> Inicio</a>
        <a href="cliente.html"><i class="fa fa-fw fa-user"></i> Cliente</a>
        <a href="maquinaria.html"><i class="fa fa-fw fa-truck"></i> Maquinaria</a>
        <a href="contacto.html"><i class="fa fa-fw fa-envelope"></i> Contacto</a>
    </div>

    <div class="container" align="center">
        <div class="main">
            <div class="textogood">
                <h1>
                    Machinery Rent
                </h1>
                <img src="image/imagen_header.png" width="50%">
            </div>       
            <br>
            <br> 

            <button class="btn success fa fa-window-restore" href='javascript:void(0);' data-custom-open="modal-1"> Gestionar</button>
            <button class="btn info fa fa-eye" onclick="showTable()"> Ver maquinas</button>

            <br>
            <br> 
            <table align="center" style="display: none;" id="tableMachine">
                <thead>
                    <tr align="center">
                        <th>id</th>
                        <th>brand</th>
                        <th>model</th>
                        <th>category_id</th>
                        <th>name</th>
                        <th>amount</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
         

            
            
            <!-- creo button y div para ventana emergente -->
            

            

            <!-- Modal -->
            <div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
                <div class="modal__overlay" tabindex="-1" data-micromodal-close>
                  <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
                    <header class="modal__header" >
                            <h2 class="centerDiv">
                              Ingrese la informaci√≥n
                            </h2>
                            <button class="modal__close" aria-label="Close modal" data-custom-close="modal-1" ></button>
                    </header>
                    <div class="modal-content-content" id="modal-1-content">
                        <div class="modal__content">
                            <div class="row" width="70%">
                                <div class="col" align="center">
                                    <label for="id" class="form-label">ID</label>
                                    <input type="number" class="form-control" id="id" placeholder="0">
                                </div>
                                <div class="col" align="center">
                                    <label for="brand" class="form-label">BRAND</label>
                                    <input type="text" class="form-control" id="brand" placeholder="marca">
                                </div>
                                <div class="col" align="center">
                                    <label for="model" class="form-label">MODEL</label>
                                    <input type="number" class="form-control" id="model" placeholder="0">
                                </div>
                                <div class="col" align="center">
                                    <label for="category_id" class="form-label">ID CATEGORY</label>
                                    <input type="number" class="form-control" id="category_id" placeholder="0">
                                </div>
                                <div class="col" align="center">
                                    <label for="name" class="form-label">NAME</label>
                                    <input type="text" class="form-control" id="name" placeholder="name">
                                </div>
                                <div class="col" align="center">
                                    <label for="amount" class="form-label">AMOUNT</label>
                                    <input type="text" class="form-control" id="name" placeholder="amount">
                                </div>
                            </div>
                        </div>
                    </div>
                    <footer class="modal__footer">
                        <!-- <div class="centerDiv" style="display: inline-block;
                        width: 0%;margin: 0;"> -->
                            <button class="modal__btn" style="background-color: #04AA6D" onclick="crear()"> Crear</button>
                            <button class="modal__btn" style="background-color: #ff9800"onclick="modificar()">Modificar</button>
                            <button class="modal__btn" style="background-color: #f44336" onclick="borrar()">Borrar</button>
                            <button class="modal__btn" data-custom-close="modal-1"
                                aria-label="Close this dialog window" id="modalClose">Close</button>
                            <!-- </div> -->
                    </footer>
                  </div>
                </div>
            </div>
            <br>
            <br> 
            
        </div>
    </div>
    

    <script src="https://cdn.jsdelivr.net/npm/micromodal/dist/micromodal.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- JavaScript Bundle with Popper -->
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
    <!-- <script type="text/javascript" src="js/app.js"></script>  -->
    
    <script>
        try {
            MicroModal.init({
            awaitOpenAnimation: true,
            awaitCloseAnimation: true,// set to false, to remove close animation
            disableFocus: false,
            openTrigger: 'data-custom-open', // [3]
            closeTrigger: 'data-custom-close', // [4]
            onShow: function(modal) {console.log("micromodal open");},
            onClose: function(modal) {console.log("micromodal close");}
        });
    
        } catch (e) {
        console.log("micromodal error: ", e);
        }

        function showTable(){
            $("#tableMachine").show();
            
        }

        
        

        function consultar() {
            $.ajax({
                url: "https://g44dabe1ff79c15-db202109272014.adb.sa-santiago-1.oraclecloudapps.com/ords/admin/machine/machine",
                type: "GET",
                dataType: "json",
                success: function (response) {
                    $('tbody').empty();
                    console.log(response);
                    response.items.forEach(element => {
                        var row = $('<tr>');
                        row.append($('<td>').text(element.id));
                        row.append($('<td>').text(element.brand));
                        row.append($('<td>').text(element.model));
                        row.append($('<td>').text(element.category_id));
                        row.append($('<td>').text(element.name));
                        row.append($('<td>').text(element.amount));
                        $('tbody').append(row);
                    });
                }
            });
        }
        
        function crear() {
            var id = $("#id").val();
            var brand = $("#brand").val();
            var model = $("#model").val();
            var category_id = $("#category_id").val();
            var name = $("#name").val();
            $.ajax({
                url: "https://g44dabe1ff79c15-db202109272014.adb.sa-santiago-1.oraclecloudapps.com/ords/admin/machine/machine",
                type: "POST",
                dataType: "json",
                data: {
                    id: id,
                    brand: brand,
                    model: model,
                    category_id: category_id,
                    name: name,
                    amount:amount
                },
                statusCode: {
                    201: function () {
                        consultar();
                    },
                    200: function () {
                        console.log("-1-1-1-1 WE GOT 200!");
                    }
                },
            });
        }
        $(document).ready(function () {
            consultar();
        });

    </script>
</body>

</html>